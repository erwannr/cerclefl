% -----------------------------------------------------------------
% Copyright (C) 2025 by Le cercle floridien (Erwann Rogard)
% Source repository: https://github.com/erwannr/cerclefl
% 
% LaTeX code:
% Released under the LaTeX Project Public License v1.3c or later
% See http://www.latex-project.org/lppl.txt
% 
% Written content (text):
% CC BY-NC-SA 4.0
% -----------------------------------------------------------------

\ProvideDocumentCommand{\StudyAidNew}{m}
{\QuestionAnswerNew{#1}}

\ProvideDocumentCommand{\StudyAidTypeset}{m}{%
  \StudyAidRatio{#1}
  \DTLforeach{studyaid-#1}{%
    \sid=id,%
    \squestion=question,%
    \sexhibit=exhibit,%
    \sanswer=answer%
  }{%      
    \begin{q-#1}
      \DTLifnull{\sexhibit}{}{%
        \sexhibit
      }%
      \squestion
    \end{q-#1}

    \begin{a-#1}
      \sanswer
    \end{a-#1}
  }%
}

\ProvideDocumentCommand{\StudyAidRatio}{m}{%
  \reversemarginpar\marginpar{%
    \IfPackageLoadedTF{tcolorbox}
    {%
      \begin{tcolorbox}[width=\marginparwidth, fontupper=\small]
        \IfPackageLoadedTF{fontawesome5}{\faChartBar{} }{}%
        \begin{tabular}{ll}
          Publiées & \CounterUse{#1-safe}\\
          Total & \CounterUse{#1-unsafe}%
        \end{tabular}
      \end{tcolorbox}
    }{%
      \small
      \begin{tabular}{ll}
        Publiées & \CounterUse{#1-safe}\\
        Total & \CounterUse{#1-unsafe}%
      \end{tabular}
    }%
  }%
}
