% -----------------------------------------------------------------
% Copyright (C) 2025 by La bergerie de Floride (Erwann Rogard)
% Source repository: https://github.com/erwannr/bergeriefl
% 
% LaTeX code:
% Released under the LaTeX Project Public License v1.3c or later
% See http://www.latex-project.org/lppl.txt
% 
% Written content (text):
% CC BY-NC-SA 4.0
% -----------------------------------------------------------------

% \ProvideExpandableDocumentCommand{\CorpusPublicationName}{s m}{% Error!
\ProvideDocumentCommand{\CorpusPublicationName}{s m}{%
  \DTLforeach[\DTLiseq{\id}{#2}]{corpus-publication}{\id=id,\name=name}{%
    \IfBooleanTF{#1}
    {\name}%
    {\hyperref[corpus-publ:\id]{\name}}%
  }
}

\ProvideDocumentCommand{\CorpusAuthorName}{s m}{%
  \DTLforeach[\DTLiseq{\id}{#2}]{corpus-author}{\id=id,\name=name}{%
    \IfBooleanTF{#1}
    {\name}%
    {\hyperref[corpus-author-\id]{\name}}%
  }
}

\ProvideDocumentCommand{\CorpusKeywordName}{s m}{%
  \DTLforeach[\DTLiseq{\id}{#2}]{corpus-keyword}{\id=id,\name=name}{%
    \IfBooleanTF{#1}
    {\name}%
    {\name
      % \hyperref[corpus-keyword-\id]{\name} % disabled until section is created
    }%
  }
}

\ProvideDocumentCommand{\CorpusQuoteTypeset}{sm}
{%
  \DTLforeach[\DTLiseq{\qid}{#2}]{corpus-quote}{%
    \qid=id,
    \qtext=text,
    \qauthorid=authorid,
    \qsource=source
  }{%
    \begin{tcolorbox}[quotestyle]
      \qtext\IfValueT{\qsource}{\qsource}
      \IfBooleanT{#1}{\AttributeQuote{\CorpusAuthorName*{\qauthorid}}}
    \end{tcolorbox}
  }
}
